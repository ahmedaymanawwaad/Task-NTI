This is the merged version after rebase

